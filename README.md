# FastAPI-xml 

A bridge between [FastAPI](https://github.com/tiangolo/fastapi) and [xsdata](https://github.com/tefra/xsdata). Together,
fastapi handles xml data structures using dataclasses generated by xsdata. Whilst, fastapi handles the api calls, xsdata
covers xml serialisation and deserialization. In addition, openapi support works as well.
 
# Install

`pip install fastapi-xml` will do the trick.


# Example

```python
from dataclasses import dataclass, field
from fastapi_xml import NonJsonRoute, XmlBody, XmlAppResponse
from fastapi import FastAPI

@dataclass
class HelloWorld:
    class Meta:
        name = "echo"
    message: str = field(metadata={"name": "Message", "type": "Element"})

app = FastAPI(default_response_class=XmlAppResponse)
app.router.route_class = NonJsonRoute

@app.post("/echo", response_model=HelloWorld)
def echo(x: HelloWorld = XmlBody()) -> HelloWorld:
    x.message += " For ever!"
    return x

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="127.0.0.1", port=8000)
```
![Hello World Example](.github/rsc/example.gif) 

# Limitations
  - This package depends on fastapi and xsdata. However, fastapi depends on
    pydantic, which ships a [bug](https://github.com/pydantic/pydantic/issues/4353) that causes several side effects.
    Among other, this bug is fixed within the major branch. Nevertheless, the bug still occurs in the current version
    (1.9.2). Anyhow, this package supports both versions. Set the environment variable 
    `FASTAPI_XML_DISABLE_PYDANTIC_PATCH != "false"` to disable that patch.

  - :warning: Do not use keyword `required` for a field's metatdata. This will crash the openapi schema generator. Remove 
    typehint `Optional` instead.